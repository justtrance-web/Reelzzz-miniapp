<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Reels Editor</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        [data-theme="dark"] {
            --bg: #0f0f1a;
            --card: #1a1a2e;
            --text: #ffffff;
            --text-dim: rgba(255,255,255,0.5);
            --accent: #5865f2;
        }
        
        [data-theme="light"] {
            --bg: #f5f5f7;
            --card: #ffffff;
            --text: #1d1d1f;
            --text-dim: rgba(0,0,0,0.5);
            --accent: #007aff;
        }
        
        [data-theme="neon"] {
            --bg: #0a0a0f;
            --card: #12121a;
            --text: #00ffaa;
            --text-dim: rgba(0,255,170,0.5);
            --accent: #ff00aa;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
            padding: 16px;
            padding-bottom: 120px;
            transition: all 0.3s;
        }
        
        .theme-switcher {
            display: flex;
            gap: 12px;
            justify-content: center;
            margin-bottom: 20px;
        }
        
        .theme-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 3px solid transparent;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .theme-btn.active {
            border-color: var(--accent);
            transform: scale(1.1);
        }
        
        .theme-btn[data-set="dark"] { background: linear-gradient(135deg, #1a1a2e, #5865f2); }
        .theme-btn[data-set="light"] { background: linear-gradient(135deg, #f5f5f7, #007aff); }
        .theme-btn[data-set="neon"] { background: linear-gradient(135deg, #00ffaa, #ff00aa); }
        
        .header {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .header h1 { font-size: 26px; margin-bottom: 6px; }
        .header p { font-size: 14px; color: var(--text-dim); }
        
        .instructions {
            background: var(--card);
            border-radius: 16px;
            padding: 16px 20px;
            margin-bottom: 24px;
        }
        
        .instructions div {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 8px 0;
        }
        
        .step {
            background: var(--accent);
            color: white;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 14px;
        }
        
        .section { margin-bottom: 24px; }
        
        .section-title {
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: var(--text-dim);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .buttons-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }
        
        .btn {
            background: var(--card);
            border: 2px solid transparent;
            border-radius: 14px;
            padding: 16px 8px;
            color: var(--text);
            font-size: 12px;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            transition: all 0.2s;
        }
        
        .btn:active { transform: scale(0.95); }
        
        .btn.selected {
            border-color: var(--accent);
            background: var(--accent);
            color: white;
        }
        
        .btn-icon { font-size: 24px; }
        
        .speed-control {
            background: var(--card);
            border-radius: 16px;
            padding: 20px;
        }
        
        .speed-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }
        
        .speed-value {
            font-size: 24px;
            font-weight: 700;
            color: var(--accent);
        }
        
        .slider {
            -webkit-appearance: none;
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: var(--bg);
        }
        
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: var(--accent);
        }
        
        .speed-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-size: 11px;
            color: var(--text-dim);
        }
        
        .selected-panel {
            background: var(--card);
            border-radius: 16px;
            padding: 16px;
            min-height: 60px;
        }
        
        .tags { display: flex; flex-wrap: wrap; gap: 8px; }
        
        .tag {
            background: var(--accent);
            color: white;
            padding: 8px 14px;
            border-radius: 20px;
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .tag .x { cursor: pointer; opacity: 0.7; }
        
        .empty { color: var(--text-dim); text-align: center; padding: 10px; }
    </style>
</head>
<body data-theme="dark">
    
    <div class="theme-switcher">
        <button class="theme-btn active" data-set="dark" onclick="setTheme('dark')"></button>
        <button class="theme-btn" data-set="light" onclick="setTheme('light')"></button>
        <button class="theme-btn" data-set="neon" onclick="setTheme('neon')"></button>
    </div>
    
    <div class="header">
        <h1>üé¨ Reels Editor</h1>
        <p>–í—ã–±–µ—Ä–∏ —ç—Ñ—Ñ–µ–∫—Ç—ã –¥–ª—è –≤–∏–¥–µ–æ</p>
    </div>
    
    <div class="instructions">
        <div><span class="step">1</span> –°–Ω–∞—á–∞–ª–∞ –æ—Ç–ø—Ä–∞–≤—å –≤–∏–¥–µ–æ –±–æ—Ç—É</div>
        <div><span class="step">2</span> –í—ã–±–µ—Ä–∏ —ç—Ñ—Ñ–µ–∫—Ç—ã –Ω–∏–∂–µ</div>
        <div><span class="step">3</span> –ù–∞–∂–º–∏ "–ü—Ä–∏–º–µ–Ω–∏—Ç—å"</div>
    </div>
    
    <div class="section">
        <div class="section-title">‚ö° –°–∫–æ—Ä–æ—Å—Ç—å</div>
        <div class="speed-control">
            <div class="speed-header">
                <span>–°–∫–æ—Ä–æ—Å—Ç—å</span>
                <span class="speed-value" id="speedVal">1x</span>
            </div>
            <input type="range" class="slider" id="speedSlider" min="0.25" max="3" step="0.25" value="1" oninput="setSpeed(this.value)">
            <div class="speed-labels">
                <span>0.25x</span><span>1x</span><span>2x</span><span>3x</span>
            </div>
        </div>
    </div>
    
    <div class="section">
        <div class="section-title">üé® –¶–≤–µ—Ç</div>
        <div class="buttons-grid">
            <button class="btn" data-e="bw" onclick="toggle('bw')"><span class="btn-icon">‚ö´</span>–ß/–ë</button>
            <button class="btn" data-e="sepia" onclick="toggle('sepia')"><span class="btn-icon">üü§</span>–°–µ–ø–∏—è</button>
            <button class="btn" data-e="negative" onclick="toggle('negative')"><span class="btn-icon">üîÑ</span>–ù–µ–≥–∞—Ç–∏–≤</button>
            <button class="btn" data-e="vintage" onclick="toggle('vintage')"><span class="btn-icon">üìº</span>–í–∏–Ω—Ç–∞–∂</button>
            <button class="btn" data-e="bright" onclick="toggle('bright')"><span class="btn-icon">‚òÄÔ∏è</span>–Ø—Ä–∫–æ—Å—Ç—å+</button>
            <button class="btn" data-e="contrast" onclick="toggle('contrast')"><span class="btn-icon">üéöÔ∏è</span>–ö–æ–Ω—Ç—Ä–∞—Å—Ç+</button>
        </div>
    </div>
    
    <div class="section">
        <div class="section-title">üîÑ –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏</div>
        <div class="buttons-grid">
            <button class="btn" data-e="mirror" onclick="toggle('mirror')"><span class="btn-icon">ü™û</span>–ó–µ—Ä–∫–∞–ª–æ</button>
            <button class="btn" data-e="flip" onclick="toggle('flip')"><span class="btn-icon">üîÉ</span>–ü–µ—Ä–µ–≤–µ—Ä–Ω—É—Ç—å</button>
            <button class="btn" data-e="rotate" onclick="toggle('rotate')"><span class="btn-icon">‚Ü©Ô∏è</span>90¬∞</button>
        </div>
    </div>
    
    <div class="section">
        <div class="section-title">üìê –§–æ—Ä–º–∞—Ç</div>
        <div class="buttons-grid">
            <button class="btn" data-e="1:1" onclick="toggle('1:1')"><span class="btn-icon">‚¨ú</span>1:1</button>
            <button class="btn" data-e="9:16" onclick="toggle('9:16')"><span class="btn-icon">üì±</span>9:16</button>
            <button class="btn" data-e="16:9" onclick="toggle('16:9')"><span class="btn-icon">üñ•Ô∏è</span>16:9</button>
        </div>
    </div>
    
    <div class="section">
        <div class="section-title">‚ú® –≠—Ñ—Ñ–µ–∫—Ç—ã</div>
        <div class="buttons-grid">
            <button class="btn" data-e="reverse" onclick="toggle('reverse')"><span class="btn-icon">‚è™</span>–†–µ–≤–µ—Ä—Å</button>
            <button class="btn" data-e="blur" onclick="toggle('blur')"><span class="btn-icon">üå´Ô∏è</span>–†–∞–∑–º—ã—Ç–∏–µ</button>
            <button class="btn" data-e="sharp" onclick="toggle('sharp')"><span class="btn-icon">üî™</span>–†–µ–∑–∫–æ—Å—Ç—å</button>
            <button class="btn" data-e="mute" onclick="toggle('mute')"><span class="btn-icon">üîá</span>–ë–µ–∑ –∑–≤—É–∫–∞</button>
            <button class="btn" data-e="gif" onclick="toggle('gif')"><span class="btn-icon">üéûÔ∏è</span>GIF</button>
        </div>
    </div>
    
    <div class="section">
        <div class="section-title">‚úÖ –í—ã–±—Ä–∞–Ω–æ</div>
        <div class="selected-panel">
            <div class="tags" id="tags"><div class="empty">–í—ã–±–µ—Ä–∏ —ç—Ñ—Ñ–µ–∫—Ç—ã –≤—ã—à–µ ‚òùÔ∏è</div></div>
        </div>
    </div>
    
    <script>
        const tg = window.Telegram.WebApp;
        tg.ready();
        tg.expand();
        
        let effects = [];
        let speed = 1;
        
        const names = {
            bw:'‚ö´ –ß/–ë', sepia:'üü§ –°–µ–ø–∏—è', negative:'üîÑ –ù–µ–≥–∞—Ç–∏–≤', vintage:'üìº –í–∏–Ω—Ç–∞–∂',
            bright:'‚òÄÔ∏è –Ø—Ä–∫–æ—Å—Ç—å+', contrast:'üéöÔ∏è –ö–æ–Ω—Ç—Ä–∞—Å—Ç+', mirror:'ü™û –ó–µ—Ä–∫–∞–ª–æ',
            flip:'üîÉ –ü–µ—Ä–µ–≤–µ—Ä–Ω—É—Ç—å', rotate:'‚Ü©Ô∏è 90¬∞', '1:1':'‚¨ú 1:1', '9:16':'üì± 9:16',
            '16:9':'üñ•Ô∏è 16:9', reverse:'‚è™ –†–µ–≤–µ—Ä—Å', blur:'üå´Ô∏è –†–∞–∑–º—ã—Ç–∏–µ',
            sharp:'üî™ –†–µ–∑–∫–æ—Å—Ç—å', mute:'üîá –ë–µ–∑ –∑–≤—É–∫–∞', gif:'üéûÔ∏è GIF'
        };
        
        function setTheme(t) {
            document.body.setAttribute('data-theme', t);
            document.querySelectorAll('.theme-btn').forEach(b => b.classList.toggle('active', b.dataset.set === t));
            localStorage.setItem('theme', t);
            tg.HapticFeedback?.impactOccurred('light');
        }
        setTheme(localStorage.getItem('theme') || 'dark');
        
        function toggle(e) {
            const btn = document.querySelector(`[data-e="${e}"]`);
            if (effects.includes(e)) {
                effects = effects.filter(x => x !== e);
                btn.classList.remove('selected');
            } else {
                effects.push(e);
                btn.classList.add('selected');
            }
            update();
            tg.HapticFeedback?.impactOccurred('light');
        }
        
        function remove(e) {
            effects = effects.filter(x => x !== e);
            document.querySelector(`[data-e="${e}"]`)?.classList.remove('selected');
            update();
        }
        
        function setSpeed(v) {
            speed = parseFloat(v);
            document.getElementById('speedVal').textContent = speed + 'x';
            update();
        }
        
        function update() {
            const t = document.getElementById('tags');
            let h = '';
            if (speed !== 1) h += `<div class="tag">‚è±Ô∏è ${speed}x <span class="x" onclick="document.getElementById('speedSlider').value=1;setSpeed(1)">‚úï</span></div>`;
            effects.forEach(e => h += `<div class="tag">${names[e]} <span class="x" onclick="remove('${e}')">‚úï</span></div>`);
            t.innerHTML = h || '<div class="empty">–í—ã–±–µ—Ä–∏ —ç—Ñ—Ñ–µ–∫—Ç—ã –≤—ã—à–µ ‚òùÔ∏è</div>';
            
            if (effects.length || speed !== 1) {
                tg.MainButton.setText('‚ú® –ü—Ä–∏–º–µ–Ω–∏—Ç—å');
                tg.MainButton.show();
            } else {
                tg.MainButton.hide();
            }
        }
        
        tg.MainButton.onClick(() => {
            tg.sendData(JSON.stringify({ effects, speed }));
            tg.HapticFeedback?.notificationOccurred('success');
        });
    </script>
</body>
</html>
